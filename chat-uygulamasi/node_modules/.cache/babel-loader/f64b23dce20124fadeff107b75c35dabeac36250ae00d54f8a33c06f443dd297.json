{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\bykgz\\\\Desktop\\\\yeni proje\\\\chat-uygulamasi\\\\src\\\\components\\\\WaitingRoom.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { db } from \"../firebase/config\";\nimport { doc, setDoc, collection, query, where, onSnapshot, deleteDoc } from \"firebase/firestore\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst WaitingRoom = ({\n  user,\n  onMatch\n}) => {\n  _s();\n  const [searching, setSearching] = useState(false);\n  useEffect(() => {\n    if (!user || !searching) return;\n    const addToWaitingRoom = async () => {\n      const waitingRef = doc(db, \"waitingRoom\", user.uid);\n      await setDoc(waitingRef, {\n        userId: user.uid,\n        displayName: user.displayName || \"Anonim\",\n        timestamp: new Date().getTime()\n      });\n    };\n    const checkForMatch = () => {\n      const waitingRoomRef = collection(db, \"waitingRoom\");\n      const q = query(waitingRoomRef, where(\"userId\", \"!=\", user.uid));\n      return onSnapshot(q, async snapshot => {\n        const waitingUsers = snapshot.docs.map(doc => doc.data());\n        if (waitingUsers.length > 0) {\n          const randomUser = waitingUsers[Math.floor(Math.random() * waitingUsers.length)];\n          const chatId = [user.uid, randomUser.userId].sort().join(\"-\");\n          await deleteDoc(doc(db, \"waitingRoom\", user.uid));\n          await deleteDoc(doc(db, \"waitingRoom\", randomUser.userId));\n          onMatch(chatId, randomUser.userId);\n          setSearching(false);\n        }\n      });\n    };\n    const unsubscribe = checkForMatch();\n    addToWaitingRoom();\n    return () => {\n      unsubscribe();\n      if (user !== null && user !== void 0 && user.uid) {\n        deleteDoc(doc(db, \"waitingRoom\", user.uid));\n      }\n    };\n  }, [user, searching]);\n  const handleCancel = async () => {\n    try {\n      setSearching(false);\n      await deleteDoc(doc(db, \"waitingRoom\", user.uid));\n      window.location.reload();\n    } catch (error) {\n      console.error(\"İptal hatası:\", error);\n    }\n  };\n  const startSearching = () => {\n    if (!user.displayName) {\n      alert(\"Lütfen önce bir kullanıcı adı belirleyin!\");\n      window.location.reload();\n      return;\n    }\n    setSearching(true);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex items-center justify-center min-h-screen bg-gradient-to-br from-primary-dark via-secondary to-secondary-dark\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-10 bg-white/90 backdrop-blur-sm rounded-2xl shadow-2xl max-w-md w-full mx-4\",\n      children: !searching ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-3xl font-bold mb-8 bg-gradient-to-r from-primary to-secondary text-transparent bg-clip-text\",\n          children: \"Sohbet Ba\\u015Flat\\u0131n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startSearching,\n          className: \"w-full bg-gradient-to-r from-primary to-secondary text-white py-4 px-8 rounded-xl\\r font-semibold hover:opacity-90 transition-all duration-200 shadow-lg\",\n          children: \"Sohbet Arkada\\u015F\\u0131 Bul\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-3xl font-bold mb-8 text-center bg-gradient-to-r from-primary to-secondary text-transparent bg-clip-text animate-pulse\",\n          children: \"Sohbet arkada\\u015F\\u0131 aran\\u0131yor...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col items-center space-y-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-20 h-20 border-4 border-primary rounded-full animate-spin border-t-transparent\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-20 h-20 border-4 border-secondary rounded-full animate-ping opacity-20 absolute top-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-600 text-center text-lg\",\n            children: \"Size en uygun sohbet arkada\\u015F\\u0131n\\u0131 bulmaya \\xE7al\\u0131\\u015F\\u0131yoruz\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleCancel,\n            className: \"mt-6 px-6 py-2 text-red-500 border border-red-500 rounded-lg hover:bg-red-50 \\r transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2\",\n            children: \"Aramay\\u0131 \\u0130ptal Et\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 5\n  }, this);\n};\n_s(WaitingRoom, \"/Wfc0+mZJQsBr1HGcaSqQ19wJbs=\");\n_c = WaitingRoom;\nexport default WaitingRoom;\nvar _c;\n$RefreshReg$(_c, \"WaitingRoom\");","map":{"version":3,"names":["useEffect","useState","db","doc","setDoc","collection","query","where","onSnapshot","deleteDoc","jsxDEV","_jsxDEV","Fragment","_Fragment","WaitingRoom","user","onMatch","_s","searching","setSearching","addToWaitingRoom","waitingRef","uid","userId","displayName","timestamp","Date","getTime","checkForMatch","waitingRoomRef","q","snapshot","waitingUsers","docs","map","data","length","randomUser","Math","floor","random","chatId","sort","join","unsubscribe","handleCancel","window","location","reload","error","console","startSearching","alert","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","_c","$RefreshReg$"],"sources":["C:/Users/bykgz/Desktop/yeni proje/chat-uygulamasi/src/components/WaitingRoom.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { db } from \"../firebase/config\";\r\nimport {\r\n  doc,\r\n  setDoc,\r\n  collection,\r\n  query,\r\n  where,\r\n  onSnapshot,\r\n  deleteDoc,\r\n} from \"firebase/firestore\";\r\n\r\nconst WaitingRoom = ({ user, onMatch }) => {\r\n  const [searching, setSearching] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!user || !searching) return;\r\n\r\n    const addToWaitingRoom = async () => {\r\n      const waitingRef = doc(db, \"waitingRoom\", user.uid);\r\n      await setDoc(waitingRef, {\r\n        userId: user.uid,\r\n        displayName: user.displayName || \"Anonim\",\r\n        timestamp: new Date().getTime(),\r\n      });\r\n    };\r\n\r\n    const checkForMatch = () => {\r\n      const waitingRoomRef = collection(db, \"waitingRoom\");\r\n      const q = query(waitingRoomRef, where(\"userId\", \"!=\", user.uid));\r\n\r\n      return onSnapshot(q, async (snapshot) => {\r\n        const waitingUsers = snapshot.docs.map((doc) => doc.data());\r\n\r\n        if (waitingUsers.length > 0) {\r\n          const randomUser =\r\n            waitingUsers[Math.floor(Math.random() * waitingUsers.length)];\r\n          const chatId = [user.uid, randomUser.userId].sort().join(\"-\");\r\n\r\n          await deleteDoc(doc(db, \"waitingRoom\", user.uid));\r\n          await deleteDoc(doc(db, \"waitingRoom\", randomUser.userId));\r\n\r\n          onMatch(chatId, randomUser.userId);\r\n          setSearching(false);\r\n        }\r\n      });\r\n    };\r\n\r\n    const unsubscribe = checkForMatch();\r\n    addToWaitingRoom();\r\n\r\n    return () => {\r\n      unsubscribe();\r\n      if (user?.uid) {\r\n        deleteDoc(doc(db, \"waitingRoom\", user.uid));\r\n      }\r\n    };\r\n  }, [user, searching]);\r\n\r\n  const handleCancel = async () => {\r\n    try {\r\n      setSearching(false);\r\n      await deleteDoc(doc(db, \"waitingRoom\", user.uid));\r\n      window.location.reload();\r\n    } catch (error) {\r\n      console.error(\"İptal hatası:\", error);\r\n    }\r\n  };\r\n\r\n  const startSearching = () => {\r\n    if (!user.displayName) {\r\n      alert(\"Lütfen önce bir kullanıcı adı belirleyin!\");\r\n      window.location.reload();\r\n      return;\r\n    }\r\n    setSearching(true);\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-primary-dark via-secondary to-secondary-dark\">\r\n      <div className=\"p-10 bg-white/90 backdrop-blur-sm rounded-2xl shadow-2xl max-w-md w-full mx-4\">\r\n        {!searching ? (\r\n          <div className=\"text-center\">\r\n            <h2 className=\"text-3xl font-bold mb-8 bg-gradient-to-r from-primary to-secondary text-transparent bg-clip-text\">\r\n              Sohbet Başlatın\r\n            </h2>\r\n            <button\r\n              onClick={startSearching}\r\n              className=\"w-full bg-gradient-to-r from-primary to-secondary text-white py-4 px-8 rounded-xl\r\n              font-semibold hover:opacity-90 transition-all duration-200 shadow-lg\"\r\n            >\r\n              Sohbet Arkadaşı Bul\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            <h2 className=\"text-3xl font-bold mb-8 text-center bg-gradient-to-r from-primary to-secondary text-transparent bg-clip-text animate-pulse\">\r\n              Sohbet arkadaşı aranıyor...\r\n            </h2>\r\n            <div className=\"flex flex-col items-center space-y-8\">\r\n              <div className=\"relative\">\r\n                <div className=\"w-20 h-20 border-4 border-primary rounded-full animate-spin border-t-transparent\"></div>\r\n                <div className=\"w-20 h-20 border-4 border-secondary rounded-full animate-ping opacity-20 absolute top-0\"></div>\r\n              </div>\r\n              <p className=\"text-gray-600 text-center text-lg\">\r\n                Size en uygun sohbet arkadaşını bulmaya çalışıyoruz\r\n              </p>\r\n              <button\r\n                onClick={handleCancel}\r\n                className=\"mt-6 px-6 py-2 text-red-500 border border-red-500 rounded-lg hover:bg-red-50 \r\n                transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2\"\r\n              >\r\n                Aramayı İptal Et\r\n              </button>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WaitingRoom;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}